<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inf√¢ncia Sem Pressa ‚Äî Adultiza√ß√£o N√£o!</title>
  <meta name="theme-color" content="#8A2BE2" />
  <meta name="description" content="Plataforma interativa gamificada contra a adultiza√ß√£o infantil. Aprenda, jogue, denuncie com seguran√ßa e conquiste selos." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet"/>
  <!-- Manifest embutido (PWA) -->
  <link rel="manifest" id="manifestLink">
  <style>
    /* =====================
       Design System
    ======================*/
    :root{
      --lavender-50:#F3ECFF;
      --lavender-300:#D9C9FF;
      --lavender-500:#B57EDC;
      --lavender-700:#8A2BE2;
      --mint-50:#E9FFF4;
      --mint-300:#C1FFC1;
      --mint-500:#98FF98;
      --mint-700:#2ecc71;
      --ink:#232323; --ink-2:#2c2c2c;
      --bg: radial-gradient(1200px 1200px at 10% 10%, var(--lavender-300) 0, transparent 40%),
            radial-gradient(1000px 1000px at 90% 20%, var(--mint-300) 0, transparent 45%),
            linear-gradient(135deg, var(--lavender-50), var(--mint-50));
      --glass: rgba(255,255,255,.6);
      --glass-strong: rgba(255,255,255,.85);
      --shadow: 0 10px 30px rgba(0,0,0,.12);
      --radius-2xl: 28px;
      --font-size: 1rem; /* acessibilidade: escala base */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body {
      margin: 0;
      font-family: 'Poppins', 'Montserrat', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, 'Helvetica Neue', Arial, sans-serif;
      color: var(--ink-2);
      background: var(--bg);
      background-attachment: fixed;
      overflow-x: hidden;
      font-size: var(--font-size);
    }

    /* Acessibilidade: alto contraste e fonte maior */
    .high-contrast{ filter: contrast(1.15) saturate(1.05); }
    .no-motion *{ animation: none !important; transition: none !important; }
    .dyslexic{ letter-spacing: .02em; word-spacing:.05em; }

    /* Header/Hero */
    header.hero { position: relative; text-align: center; padding: clamp(2.5rem, 6vw, 6rem) 1rem 3rem; color: #fff; isolation: isolate; }
    .hero .halo{ position:absolute; inset:-10vmin; z-index:-1; filter: blur(40px); opacity:.9; background: conic-gradient(from 180deg at 50% 50%, var(--lavender-500), var(--mint-500), var(--lavender-500)); mask-image: radial-gradient(closest-side, #0008, transparent); border-radius: 50%; animation: spin 20s linear infinite; }
    @keyframes spin{ to{ transform: rotate(360deg);} }
    header h1 { font-size: clamp(2rem, 4.8vw, 4rem); margin: 0 0 .5rem; font-weight: 800; letter-spacing: .2px; text-shadow: 0 6px 20px rgba(0,0,0,.25); }
    header p.sub{ margin: 0 auto 1.5rem; max-width: 900px; font-size: clamp(1rem, 1.5vw, 1.2rem); opacity:.95; }
    .cta-wrap{display:flex; gap:.8rem; justify-content:center; flex-wrap:wrap}
    .btn{ --btn-bg: var(--mint-500); --btn-fg: #142016; display:inline-flex; align-items:center; gap:.6rem; border:none; cursor:pointer; padding:.9rem 1.2rem; font-weight:700; border-radius: 999px; box-shadow: 0 6px 18px rgba(0,0,0,.18); background: var(--btn-bg); color: var(--btn-fg); transition: transform .15s ease, filter .2s ease; }
    .btn .icon{font-size:1.2rem}
    .btn:hover{ transform: translateY(-2px); filter: saturate(1.1)}
    .btn.primary{ --btn-bg: linear-gradient(135deg, var(--lavender-500), var(--mint-500)); --btn-fg:#fff; }

    /* Navbar */
    nav.nav{ position: sticky; top:0; z-index:50; backdrop-filter: blur(10px); background: color-mix(in oklab, var(--glass) 60%, #fff 40%); border-bottom: 1px solid color-mix(in oklab, var(--lavender-500) 25%, transparent); }
    .nav-inner{max-width:1100px; margin:auto; display:flex; align-items:center; justify-content:space-between; padding:.6rem 1rem}
    .brand{display:flex; align-items:center; gap:.6rem; font-weight:800}
    .brand .logo{width:34px; height:34px; border-radius:50%; background: radial-gradient(circle at 30% 30%, var(--mint-500), var(--lavender-500)); box-shadow: inset 0 0 18px rgba(255,255,255,.6)}
    .links{display:flex; gap:.6rem; flex-wrap:wrap}
    .chip{padding:.45rem .9rem; border-radius:999px; background: rgba(255,255,255,.7); border:1px solid rgba(0,0,0,.05); font-weight:600; cursor:pointer}
    .chip:hover{background:#fff}

    /* Sections */
    section{padding: clamp(1.2rem, 3vw, 2rem);} .container{max-width:1100px; margin:auto}
    .card{ background: var(--glass); border-radius: var(--radius-2xl); box-shadow: var(--shadow); padding: clamp(1rem, 2.4vw, 1.8rem); backdrop-filter: blur(14px); transition: transform .25s ease, background .25s ease; }
    .card:hover{ transform: translateY(-4px); background: var(--glass-strong)}
    h2.section-title{font-size: clamp(1.6rem, 3.2vw, 2.2rem); margin:0 0 1rem; display:flex; align-items:center; gap:.6rem}
    .kicker{font-size:.9rem; font-weight:700; letter-spacing:.08em; text-transform:uppercase; color:#3b3b3b; opacity:.8}

    .grid{display:grid; gap:1rem}
    @media (min-width: 760px){ .grid.cols-2{grid-template-columns: 1fr 1fr} .grid.cols-3{grid-template-columns: repeat(3,1fr)} }

    ul.clean{list-style:none; padding:0; margin:0}
    ul.clean li{padding:.7rem .8rem; border-radius:16px; background: rgba(255,255,255,.7); border:1px solid rgba(0,0,0,.05); margin:.5rem 0}

    /* Quiz */
    .quiz{display:grid; gap:1rem}
    .q-title{font-weight:700}
    .option{display:block; padding:.9rem; border-radius:16px; background:#E6E6FA; cursor:pointer; border:2px solid transparent}
    .option:hover{background:#D8BFD8}
    .option.correct{background: var(--mint-500); border-color: var(--mint-700); color:#11301e}
    .option.wrong{background:#ffb6c1; border-color:#e74c3c}
    .score{font-weight:700}
    .pill{display:inline-flex; padding:.35rem .7rem; border-radius:999px; background: #fff; border:1px solid rgba(0,0,0,.06); font-weight:700}

    /* Rewards */
    .rewards{display:flex; flex-wrap:wrap; gap:.6rem}
    .badge{display:inline-grid; place-items:center; width:80px; aspect-ratio:1/1; border-radius:50%; background:#fff; box-shadow: var(--shadow); font-size:1.8rem; position:relative}
    .badge span{position:absolute; bottom:6px; font-size:.7rem; font-weight:800}

    /* Miss√µes */
    .mission{display:flex; gap:.8rem; align-items:center; background: rgba(255,255,255,.8); border:1px solid rgba(0,0,0,.06); padding:.7rem; border-radius:16px}
    .mission input{width:22px; height:22px}
    .mission .pts{margin-left:auto; font-weight:800}

    /* Den√∫ncia */
    .report form{display:grid; gap:.6rem}
    .report textarea{min-height:120px; resize:vertical; padding:.8rem; border-radius:16px; border:1px solid rgba(0,0,0,.08)}
    .report select,.report input{padding:.7rem; border-radius:14px; border:1px solid rgba(0,0,0,.08)}

    /* Ranking */
    .leaderboard table{width:100%; border-collapse: collapse}
    .leaderboard th, .leaderboard td{padding:.6rem; border-bottom:1px solid rgba(0,0,0,.08); text-align:left}

    /* Footer */
    footer{ text-align:center; padding:2rem 1rem; color:#fff; background: linear-gradient(120deg, var(--lavender-500), var(--mint-500)); border-radius: 30px 30px 0 0; margin-top:2rem }

    @media (prefers-reduced-motion: reduce){ .hero .halo{animation:none} .btn{transition:none} }

    /* Floating confetti canvas */
    #fx{position:fixed; inset:0; pointer-events:none}
  </style>
</head>
<body>
  <canvas id="fx" aria-hidden="true"></canvas>

  <header class="hero" role="banner">
    <div class="halo" aria-hidden="true"></div>
    <h1>üå± Inf√¢ncia Sem Pressa</h1>
    <p class="sub">Plataforma interativa para conscientiza√ß√£o e combate √† <strong>adultiza√ß√£o infantil</strong>. Aprenda, jogue, denuncie com seguran√ßa e conquiste selos de impacto social.</p>
    <div class="cta-wrap" role="group" aria-label="A√ß√µes principais">
      <button class="btn primary" id="startQuizBtn" aria-describedby="quiz-desc"><span class="icon">üéÆ</span> Come√ßar Quiz</button>
      <a class="btn" href="#missoes"><span class="icon">üß©</span> Miss√µes do Bem</a>
      <button class="btn" id="shareBtn" title="Compartilhar"><span class="icon">üîó</span> Compartilhar</button>
      <a class="btn" target="_blank" rel="noopener" href="https://wa.me/5582981884515?text=Quero%20fazer%20uma%20den%C3%BAncia%20de%20adultiza%C3%A7%C3%A3o%20infantil"><span class="icon">üö®</span> Denunciar no WhatsApp</a>
      <button class="btn" id="installBtn" hidden><span class="icon">‚¨áÔ∏è</span> Instalar App</button>
    </div>
  </header>

  <nav class="nav" aria-label="Navega√ß√£o da p√°gina">
    <div class="nav-inner">
      <div class="brand"><div class="logo" aria-hidden="true"></div> <span>Crescer Sem Pressa</span></div>
      <div class="links">
        <a class="chip" href="#sobre">Sobre</a>
        <a class="chip" href="#sinais">Sinais</a>
        <a class="chip" href="#agir">Como agir</a>
        <a class="chip" href="#quiz">Quiz</a>
        <a class="chip" href="#missoes">Miss√µes</a>
        <a class="chip" href="#premios">Pr√™mios</a>
        <a class="chip" href="#denuncia">Den√∫ncia</a>
        <a class="chip" href="#acessibilidade">Acessibilidade</a>
        <a class="chip" href="#ranking">Ranking</a>
      </div>
    </div>
  </nav>

  <main id="main" tabindex="-1">
    <section id="sobre" class="container">
      <div class="card">
        <span class="kicker">Entenda</span>
        <h2 class="section-title">O que √© adultiza√ß√£o?</h2>
        <p>A adultiza√ß√£o acontece quando crian√ßas s√£o pressionadas a assumir comportamentos, responsabilidades ou apar√™ncias que n√£o condizem com sua idade. Isso pode gerar impactos emocionais, sociais e no desenvolvimento. Nosso objetivo √© <strong>informar</strong>, <strong>mobilizar</strong> e <strong>conectar</strong> redes de apoio.</p>
      </div>
    </section>

    <section id="sinais" class="container">
      <div class="grid cols-2">
        <div class="card">
          <h2 class="section-title">Como identificar?</h2>
          <ul class="clean" aria-label="Lista de sinais de adultiza√ß√£o">
            <li>üì∫ Exposi√ß√£o precoce a conte√∫dos adultos</li>
            <li>üíÑ Press√£o est√©tica e sexualiza√ß√£o da inf√¢ncia</li>
            <li>üßπ Responsabilidades dom√©sticas/financeiras exageradas</li>
            <li>üö´ Falta de tempo para brincar e conviver</li>
          </ul>
        </div>
        <div class="card">
          <h2 class="section-title">Rede de apoio</h2>
          <ul class="clean">
            <li>üë®‚Äçüë©‚Äçüëß Fam√≠lia e cuidadores atentos</li>
            <li>üè´ Escola (coordena√ß√£o, professores, orienta√ß√£o)</li>
            <li>üß† Psicologia, assist√™ncia social e sa√∫de</li>
            <li>‚öñÔ∏è Conselhos tutelares e canais oficiais</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="agir" class="container">
      <div class="card">
        <h2 class="section-title">Como agir?</h2>
        <p>Ao identificar situa√ß√µes de risco, <strong>dialogue</strong>, ofere√ßa <strong>apoio</strong> e, se necess√°rio, <strong>denuncie</strong>. Voc√™ pode usar o bot√£o de WhatsApp acima ou preencher o formul√°rio an√¥nimo abaixo, que gera uma mensagem pronta para enviar.</p>
        <div style="display:flex; gap:.8rem; flex-wrap:wrap">
          <a class="btn" target="_blank" rel="noopener" href="https://wa.me/5582981884515?text=Quero%20fazer%20uma%20den%C3%BAncia%20de%20adultiza%C3%A7%C3%A3o%20infantil"><span class="icon">üí¨</span> WhatsApp</a>
          <a class="btn" href="#denuncia"><span class="icon">üìù</span> Formul√°rio an√¥nimo</a>
        </div>
      </div>
    </section>

    <section id="quiz" class="container" aria-labelledby="quiz-title">
      <div class="card quiz">
        <h2 id="quiz-title" class="section-title">üéØ Quiz Interativo</h2>
        <p id="quiz-desc">Responda e aprenda. Use <kbd>1-4</kbd> no teclado para escolher. A pontua√ß√£o √© convertida em pontos para pr√™mios.</p>
        <div id="quiz-container"></div>
        <p id="score" class="score" aria-live="polite"></p>
        <div style="display:flex; gap:.6rem; flex-wrap:wrap">
          <button class="btn" id="prevQ" aria-label="Pergunta anterior">‚üµ</button>
          <button class="btn" id="nextQ" aria-label="Pr√≥xima pergunta">‚ü∂</button>
          <span class="pill">Seus pontos: <strong id="points">0</strong></span>
        </div>
      </div>
    </section>

    <section id="missoes" class="container">
      <div class="card">
        <h2 class="section-title">üß© Miss√µes do Bem</h2>
        <p>Pequenas a√ß√µes que valem <strong>pontos</strong> e geram impacto real. Marque quando concluir ‚Äî fica salvo no seu dispositivo.</p>
        <div class="grid">
          <label class="mission"><input type="checkbox" data-pts="5"> Conversar com uma crian√ßa sobre o direito de brincar <span class="pts">+5</span></label>
          <label class="mission"><input type="checkbox" data-pts="8"> Compartilhar um conte√∫do informativo com respons√°veis <span class="pts">+8</span></label>
          <label class="mission"><input type="checkbox" data-pts="10"> Sugerir pauta sobre inf√¢ncia segura na escola <span class="pts">+10</span></label>
          <label class="mission"><input type="checkbox" data-pts="12"> Mapear a rede de apoio do bairro <span class="pts">+12</span></label>
        </div>
        <div style="margin-top:.8rem; display:flex; gap:.6rem; flex-wrap:wrap">
          <button class="btn" id="resetMissions">Reiniciar miss√µes</button>
          <button class="btn" id="claimBadge">Trocar 20 pts por selo</button>
        </div>
      </div>
    </section>

    <section id="premios" class="container">
      <div class="grid cols-2">
        <div class="card">
          <h2 class="section-title">üèÜ Hall da Empatia</h2>
          <p>Conquiste e <em>baixe</em> seus selos como imagem para compartilhar!</p>
          <div id="rewards" class="rewards" aria-live="polite"></div>
        </div>
        <div class="card">
          <h2 class="section-title">Regras & Crit√©rios (para pr√™mios)</h2>
          <ul class="clean">
            <li>üéÆ Quiz: 10 pts por acerto.</li>
            <li>üß© Miss√µes: pontos vari√°veis (veja cada miss√£o).</li>
            <li>üåü Selo: custa 20 pts. Baixe e compartilhe.</li>
            <li>üîí Tudo fica salvo no seu dispositivo (LocalStorage).</li>
          </ul>
          <button class="btn" id="downloadAll">Baixar todos os selos</button>
        </div>
      </div>
    </section>

    <section id="denuncia" class="container report">
      <div class="card">
        <h2 class="section-title">üìù Den√∫ncia An√¥nima (gera mensagem)</h2>
        <form id="reportForm">
          <label>
            Tipo de situa√ß√£o
            <select name="tipo" required>
              <option value="Exposi√ß√£o a conte√∫do impr√≥prio">Exposi√ß√£o a conte√∫do impr√≥prio</option>
              <option value="Press√£o est√©tica/sexualiza√ß√£o">Press√£o est√©tica/sexualiza√ß√£o</option>
              <option value="Responsabilidades exageradas">Responsabilidades exageradas</option>
              <option value="Outros">Outros</option>
            </select>
          </label>
          <label>
            Idade aproximada da crian√ßa
            <input type="number" name="idade" min="0" max="17" placeholder="Ex.: 9" required />
          </label>
          <label>
            Descri√ß√£o (n√£o inclua dados sens√≠veis como nomes completos)
            <textarea name="descricao" maxlength="500" placeholder="Conte de forma objetiva o que est√° acontecendo" required></textarea>
          </label>
          <div style="display:flex; gap:.6rem; flex-wrap:wrap">
            <button type="submit" class="btn primary">Gerar mensagem</button>
            <a id="sendWa" class="btn" target="_blank" rel="noopener">Enviar por WhatsApp</a>
          </div>
        </form>
      </div>
    </section>

    <section id="acessibilidade" class="container">
      <div class="card">
        <h2 class="section-title">üõ†Ô∏è Acessibilidade</h2>
        <p>Ajuste a experi√™ncia de acordo com sua prefer√™ncia:</p>
        <div style="display:flex; gap:.6rem; flex-wrap:wrap; align-items:center">
          <button class="btn" id="toggleContrast">Alto contraste</button>
          <button class="btn" id="toggleMotion">Reduzir movimento</button>
          <button class="btn" id="toggleDyslexic">Fonte amig√°vel para dislexia</button>
          <label class="pill">Tamanho da fonte: <input id="fontRange" type="range" min="0.9" max="1.4" value="1" step="0.05" style="width:160px; margin-left:.5rem"></label>
        </div>
      </div>
    </section>

    <section id="ranking" class="container leaderboard">
      <div class="card">
        <h2 class="section-title">ü•á Ranking Local</h2>
        <p>Salve sua pontua√ß√£o com um apelido e dispute o topo deste dispositivo!</p>
        <div style="display:flex; gap:.6rem; flex-wrap:wrap; align-items:center">
          <input id="nick" placeholder="Seu apelido" aria-label="Apelido" style="padding:.6rem;border-radius:14px;border:1px solid rgba(0,0,0,.1)">
          <button class="btn" id="saveScore">Salvar pontua√ß√£o atual</button>
          <button class="btn" id="resetRanking">Limpar ranking</button>
        </div>
        <div style="margin-top:1rem; overflow:auto">
          <table aria-label="Tabela de ranking">
            <thead><tr><th>#</th><th>Apelido</th><th>Pontos</th><th>Data</th></tr></thead>
            <tbody id="rankBody"></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Inf√¢ncia Sem Pressa ‚Äî Construindo uma cultura de inf√¢ncia protegida.</p>
  </footer>

  <script>
    /* =====================
       Manifest inline (data URL) + Service Worker via Blob
    ======================*/
    const manifest = {
      name: "Crescer Sem Pressa",
      short_name: "CSP",
      start_url: ".",
      display: "standalone",
      background_color: "#E9FFF4",
      theme_color: "#8A2BE2",
      icons: [
        { src: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Cdefs/%3E%3Ccircle cx='64' cy='64' r='60' fill='%2398FF98'/%3E%3Ccircle cx='64' cy='64' r='40' fill='white'/%3E%3Ctext x='64' y='78' font-size='56' text-anchor='middle'%3E%F0%9F%8C%B1%3C/text%3E%3C/svg%3E", sizes: "128x128", type: "image/svg+xml" }
      ]
    }
    const manifestBlob = new Blob([JSON.stringify(manifest)], {type:'application/manifest+json'});
    const manifestURL = URL.createObjectURL(manifestBlob);
    document.getElementById('manifestLink').setAttribute('href', manifestURL);

    if('serviceWorker' in navigator){
      const swCode = `
        const CACHE = 'csp-v1';
        self.addEventListener('install', e=>{
          e.waitUntil(caches.open(CACHE).then(c=>c.addAll(['./'])));
          self.skipWaiting();
        });
        self.addEventListener('activate', e=>{ e.waitUntil(self.clients.claim()); });
        self.addEventListener('fetch', e=>{
          const req = e.request;
          e.respondWith(
            caches.match(req).then(res=> res || fetch(req).then(net=>{
              const copy = net.clone();
              caches.open(CACHE).then(c=> c.put(req, copy));
              return net;
            }).catch(()=> caches.match('./')))
          );
        });
      `;
      const blob = new Blob([swCode], {type:'text/javascript'});
      const swUrl = URL.createObjectURL(blob);
      navigator.serviceWorker.register(swUrl);
    }

    /* =====================
       Estado & utilidades
    ======================*/
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const state = {
      points: Number(localStorage.getItem('csp_points')||0),
      badges: JSON.parse(localStorage.getItem('csp_badges')||'[]'),
      missions: JSON.parse(localStorage.getItem('csp_missions')||'{}'),
      ranking: JSON.parse(localStorage.getItem('csp_ranking')||'[]')
    };
    const updatePointsUI = () => { $('#points').textContent = state.points; };
    const save = () => {
      localStorage.setItem('csp_points', state.points);
      localStorage.setItem('csp_badges', JSON.stringify(state.badges));
      localStorage.setItem('csp_missions', JSON.stringify(state.missions));
      localStorage.setItem('csp_ranking', JSON.stringify(state.ranking));
    };

    /* =====================
       Confetti (canvas)
    ======================*/
    const fx = document.getElementById('fx');
    const ctx = fx.getContext('2d');
    let confetti = [];
    const resize = () => { fx.width = innerWidth; fx.height = innerHeight; };
    addEventListener('resize', resize); resize();
    function spawnConfetti(n=60){ for(let i=0;i<n;i++){ confetti.push({x:Math.random()*fx.width, y:-10, r:2+Math.random()*4, vy:1+Math.random()*3, vx:-1+Math.random()*2, a:Math.random()*Math.PI}); } }
    function tick(){ ctx.clearRect(0,0,fx.width,fx.height); confetti.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; p.a+=.05; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.a); ctx.fillStyle = Math.random()>.5? '#B57EDC':'#98FF98'; ctx.fillRect(-p.r,-p.r,p.r*2,p.r*2); ctx.restore(); }); confetti = confetti.filter(p=>p.y<fx.height+20); requestAnimationFrame(tick); }
    tick();

    /* =====================
       Quiz 
    ======================*/
    const quizData = [
      { question: "O que √© adultiza√ß√£o infantil?", options: ["Dar liberdade para brincar","Pressionar crian√ßas a assumir pap√©is de adultos","Oferecer apoio emocional","Garantir acesso √† escola"], answer: 1 },
      { question: "Qual destes √© um sinal de adultiza√ß√£o?", options: ["Crian√ßa se divertindo no parque","Exposi√ß√£o precoce a conte√∫dos adultos","Desenhar com amigos","Rotina de sono saud√°vel"], answer: 1 },
      { question: "O que fazer ao identificar adultiza√ß√£o?", options: ["Ignorar para n√£o causar conflito","Dialogar, apoiar e denunciar se necess√°rio","Publicar nas redes para expor","Deixar a crian√ßa decidir sozinha"], answer: 1 }
    ];

    let currentQuestion = 0; let score = 0;
    const quizContainer = document.getElementById('quiz-container');
    const scoreEl = document.getElementById('score');

    function startQuiz(){ currentQuestion = 0; score = 0; quizContainer.innerHTML=''; scoreEl.textContent=''; loadQuestion(); }
    function loadQuestion(){
      if(currentQuestion >= quizData.length){
        quizContainer.innerHTML = `<p>üéâ Fim do quiz!</p>`;
        scoreEl.textContent = `Voc√™ acertou ${score} de ${quizData.length}!`;
        const earned = score * 10; state.points += earned; save(); updatePointsUI(); spawnConfetti(100); return;
      }
      const q = quizData[currentQuestion];
      quizContainer.innerHTML = `
        <div class="q-title">${q.question}</div>
        ${q.options.map((opt,i)=>`<button class="option" data-i="${i}"><span>${i+1}. </span>${opt}</button>`).join('')}
      `;
      $$('.option', quizContainer).forEach(btn=> btn.addEventListener('click', ()=> checkAnswer(btn, Number(btn.dataset.i))));
    }
    function checkAnswer(el, selected){ const q = quizData[currentQuestion]; $$('.option').forEach(o=>o.disabled=true); if(selected === q.answer){ el.classList.add('correct'); score++; } else { el.classList.add('wrong'); $$('.option')[q.answer].classList.add('correct'); } setTimeout(()=>{ currentQuestion++; loadQuestion(); }, 800); }
    function prevQ(){ if(currentQuestion>0){ currentQuestion--; loadQuestion(); } }
    function nextQ(){ if(currentQuestion<quizData.length){ loadQuestion(); } }

    document.getElementById('prevQ').addEventListener('click', prevQ);
    document.getElementById('nextQ').addEventListener('click', nextQ);
    document.getElementById('startQuizBtn').addEventListener('click', startQuiz);
    addEventListener('keydown', (e)=>{ const idx = ['1','2','3','4'].indexOf(e.key); if(idx>-1){ const btn = $$('.option')[idx]; if(btn) btn.click(); } });

    /* =====================
       Miss√µes (gamifica√ß√£o)
    ======================*/
    const missionEls = $$('.mission input');
    function loadMissions(){ missionEls.forEach((el, i)=>{ const id = 'm'+i; el.checked = Boolean(state.missions[id]); }); }
    function updateMission(el){ const idx = missionEls.indexOf? missionEls.indexOf(el) : $$('.mission input').indexOf(el); const id = 'm'+idx; if(el.checked && !state.missions[id]){ state.missions[id]=true; state.points += Number(el.dataset.pts||0); spawnConfetti(40); } if(!el.checked && state.missions[id]){ delete state.missions[id]; } save(); updatePointsUI(); }
    missionEls.forEach(el=> el.addEventListener('change', ()=> updateMission(el)) );
    $('#resetMissions').addEventListener('click', ()=>{ state.missions={}; missionEls.forEach(el=> el.checked=false); save(); });

    /* =====================
       Badges (selos) & download
    ======================*/
    const rewards = document.getElementById('rewards');
    function renderBadges(){ rewards.innerHTML = state.badges.map((b,i)=> badgeTemplate(b,i)).join(''); $$('.badge').forEach(b=> b.addEventListener('click', ()=> downloadBadge(b)) ); }
    function badgeTemplate(badge, idx){ const emoji = badge.emoji || 'üåü'; const name = badge.name || 'Selo'; return `<div class="badge" data-idx="${idx}" title="Clique para baixar"><div style="font-size:2rem">${emoji}</div><span>${name}</span></div>` }
    function claimBadge(){ if(state.points < 20){ alert('Voc√™ precisa de pelo menos 20 pontos para um selo!'); return; } state.points -= 20; const defs = [{emoji:'üå±', name:'Guardi√£(o) da Inf√¢ncia'},{emoji:'üß©', name:'Agente de Prote√ß√£o'},{emoji:'üí¨', name:'Embaixador(a) do Di√°logo'},{emoji:'‚ú®', name:'Olhar Atento'}]; const b = defs[Math.floor(Math.random()*defs.length)]; state.badges.push(b); save(); updatePointsUI(); renderBadges(); spawnConfetti(80); }
    function downloadBadge(el){ const canvas = document.createElement('canvas'); canvas.width = 512; canvas.height = 512; const c = canvas.getContext('2d'); const grd = c.createLinearGradient(0,0,512,512); grd.addColorStop(0, '#B57EDC'); grd.addColorStop(1, '#98FF98'); c.fillStyle = grd; c.fillRect(0,0,512,512); c.fillStyle = '#fff'; c.beginPath(); c.arc(256,256,190,0,Math.PI*2); c.fill(); c.font = '200px serif'; c.textAlign='center'; c.textBaseline='middle'; c.fillText(el.querySelector('div').textContent.trim(), 256, 230); c.fillStyle = '#333'; c.font = 'bold 32px Montserrat, Arial'; c.fillText(el.querySelector('span').textContent, 256, 380); const url = canvas.toDataURL('image/png'); const a = document.createElement('a'); a.href = url; a.download = 'selo-crescer-sem-pressa.png'; a.click(); }
    $('#claimBadge').addEventListener('click', claimBadge);
    $('#downloadAll').addEventListener('click', ()=>{ $$('.badge').forEach(b=> downloadBadge(b)); });

    /* =====================
       Den√∫ncia -> WhatsApp
    ======================*/
    const form = document.getElementById('reportForm');
    const sendWa = document.getElementById('sendWa');
    form.addEventListener('submit', (e)=>{ e.preventDefault(); const data = Object.fromEntries(new FormData(form).entries()); const msg = `Den√∫ncia an√¥nima ‚Äî Crescer Sem Pressa%0A`+`Tipo: ${encodeURIComponent(data.tipo)}%0A`+`Idade aproximada: ${encodeURIComponent(data.idade)}%0A`+`Descri√ß√£o: ${encodeURIComponent(data.descricao)}`; sendWa.href = `https://wa.me/5582996696084?text=${msg}`; sendWa.textContent = 'Abrir WhatsApp com mensagem'; alert('Mensagem gerada! Clique em "Abrir WhatsApp com mensagem".'); });

    /* =====================
       Compartilhar (Web Share API)
    ======================*/
    document.getElementById('shareBtn').addEventListener('click', async ()=>{ const shareData = { title: 'Inf√¢ncia Sem Pressa', text:'Conhe√ßa este site interativo contra a adultiza√ß√£o infantil.', url: location.href }; try{ if(navigator.share){ await navigator.share(shareData); } else { await navigator.clipboard.writeText(location.href); alert('Link copiado!'); } } catch(e){ console.log(e); } });

    /* =====================
       Acessibilidade: toggles
    ======================*/
    const root = document.documentElement; const body = document.body;
    $('#toggleContrast').addEventListener('click', ()=> body.classList.toggle('high-contrast'));
    $('#toggleMotion').addEventListener('click', ()=> body.classList.toggle('no-motion'));
    $('#toggleDyslexic').addEventListener('click', ()=> body.classList.toggle('dyslexic'));
    $('#fontRange').addEventListener('input', (e)=>{ root.style.setProperty('--font-size', e.target.value + 'rem'); });

    /* =====================
       Ranking Local
    ======================*/
    const rankBody = document.getElementById('rankBody');
    function renderRanking(){ rankBody.innerHTML = state.ranking.slice(0,20).map((r,i)=>`<tr><td>${i+1}</td><td>${r.nick}</td><td>${r.points}</td><td>${new Date(r.date).toLocaleDateString()}</td></tr>`).join(''); }
    $('#saveScore').addEventListener('click', ()=>{ const nick = $('#nick').value.trim() || 'Visitante'; state.ranking.push({nick, points: state.points, date: Date.now()}); state.ranking.sort((a,b)=> b.points - a.points); state.ranking = state.ranking.slice(0,50); save(); renderRanking(); spawnConfetti(60); });
    $('#resetRanking').addEventListener('click', ()=>{ if(confirm('Tem certeza que deseja limpar o ranking local?')){ state.ranking=[]; save(); renderRanking(); } });

    /* =====================
       PWA: bot√£o de instala√ß√£o
    ======================*/
    let deferredPrompt; const installBtn = document.getElementById('installBtn');
    window.addEventListener('beforeinstallprompt', (e)=>{ e.preventDefault(); deferredPrompt = e; installBtn.hidden = false; });
    installBtn.addEventListener('click', async ()=>{ if(!deferredPrompt) return; deferredPrompt.prompt(); const { outcome } = await deferredPrompt.userChoice; if(outcome==='accepted'){ installBtn.hidden = true; } deferredPrompt = null; });

    /* =====================
       Inicializa√ß√£o
    ======================*/
    function init(){ loadMissions(); updatePointsUI(); renderBadges(); renderRanking(); }
    init();
  </script>
</body>
</html>


          

